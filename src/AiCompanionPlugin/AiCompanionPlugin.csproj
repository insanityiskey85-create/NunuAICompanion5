<Project Sdk="Microsoft.NET.Sdk">
	<PropertyGroup>
		<TargetFramework>net9.0</TargetFramework>
		<Nullable>enable</Nullable>
		<LangVersion>latest</LangVersion>
		<AllowUnsafeBlocks>true</AllowUnsafeBlocks>
		<ImplicitUsings>enable</ImplicitUsings>

		<!-- Plugin metadata -->
		<AssemblyName>AiCompanionPlugin</AssemblyName>
		<RootNamespace>AiCompanionPlugin</RootNamespace>
		<Description>Isolated AI chat companion for FFXIV (Dalamud API 13).</Description>
		<Version>1.0.2.9</Version>

		<!-- Packaging -->
		<IsPackable>true</IsPackable>
		<OutputType>Library</OutputType>

		<!-- Where your local Dalamud references live -->
		<!-- Default to the Hooks/dev folder; you can override by setting $(DalamudLibPath) in your user environment or msbuild properties -->
		<DalamudLibPath Condition=" '$(DalamudLibPath)' == '' ">
			$(AppData)\XIVLauncher\addon\Hooks\dev
		</DalamudLibPath>

		<!-- Make sure reference DLLs are not copied next to the plugin -->
		<CopyLocalLockFileAssemblies>false</CopyLocalLockFileAssemblies>
		<ProduceReferenceAssembly>false</ProduceReferenceAssembly>
	</PropertyGroup>

	<ItemGroup>
		<!-- Needed for packaging the plugin into a zip -->
		<PackageReference Include="DalamudPackager" Version="2.1.10" PrivateAssets="all" />
	</ItemGroup>

	<ItemGroup>
		<!-- Core Dalamud runtime (includes Dalamud.Plugin, Services, and IPC namespaces) -->
		<Reference Include="Dalamud">
			<HintPath>$(DalamudLibPath)\Dalamud.dll</HintPath>
			<Private>false</Private>
		</Reference>

		<!-- Use Dalamud-provided ImGui bindings, NOT ImGuiNET -->
		<Reference Include="Dalamud.Bindings.ImGui">
			<HintPath>$(DalamudLibPath)\Dalamud.Bindings.ImGui.dll</HintPath>
			<Private>false</Private>
		</Reference>
	</ItemGroup>

	<!-- Optional: copy persona/memory templates into build output for convenience -->
	<ItemGroup>
		<None Include="persona.txt" CopyToOutputDirectory="PreserveNewest" Condition="Exists('persona.txt')" />
		<None Include="README.md" CopyToOutputDirectory="PreserveNewest" Condition="Exists('README.md')" />
	</ItemGroup>

	<!-- Import the packager targets if present -->
	<Import Project="$(DalamudLibPath)\DalamudPackager.targets" Condition="Exists('$(DalamudLibPath)\DalamudPackager.targets')" />
</Project>
